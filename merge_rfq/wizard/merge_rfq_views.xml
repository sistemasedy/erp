<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!--    Form view of the merge RFQ wizard-->
    <record id="merge_rfq_view_form" model="ir.ui.view">
        <field name="name">merge.rfq.view.form</field>
        <field name="model">merge.rfq</field>
        <field name="arch" type="xml">
            <form string="Purchase Order Merge">
                <group>
                    <field name="select_all_suppliers"/>
                    <field name="partner_id" attrs="{'invisible': [('select_all_suppliers', '=', True)]}"/>
                </group>
                <group>
                    <field name="start_date"/>
                    <field name="end_date"/>
                    
                </group>
                <footer>
                    <button string="Ejecutar Automatización" type="object" name="create_or_update_purchase_orders" class="btn-primary"/>
                    <button string="Cancel" class="btn-default"
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    <!--    Action for merge RFQ wizard-->
    <record id="merge_rfq_action" model="ir.actions.act_window">
        <field name="name">Ordenes Automatizadas</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">merge.rfq</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="merge_rfq_view_form"/>
        <field name="target">new</field>
        <field name="binding_model_id" ref="purchase.model_purchase_order"/>
        <field name="binding_view_types">list</field>
    </record>


    <menuitem id="menu_auto_purchase" name="Auto Compra" sequence="3" />
    <menuitem id="sub_menu_auto" parent="purchase.menu_purchase_root" name="Auto Compra" sequence="1"/>
    <menuitem action="merge_rfq_action" id="menu_loan_req" parent="sub_menu_auto" name="Solicitudes de Auto Compra" sequence="2"/>


    <record id="view_product_form_inherited" model="ir.ui.view">
        <field name="name">product.form.inherited</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_tree_view"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='barcode']" position="after">
                <field name="seller_ids" widget="many2many_tags"/>
                <field name="ignore_product"/>
            </xpath>
        </field>
    </record>
    <record id="view_product_form_inherited" model="ir.ui.view">
        <field name="name">product.form.inherited</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='sales']" position="after">
                <page name="automation" string="Automatizacion">
                    <group>
                        <group name="precios_valores">
                            <field name="main_supplier_id"/>
                        </group>
                        <group name="precios_valores">
                            <field name="auto_reorder"/>
                        </group>
                        <group name="precios_valores">
                            <field name="ignore_product"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>


    <record id="view_purchase_order_automation_dashboard" model="ir.ui.view">
        <field name="name">purchase.order.automation.dashboard</field>
        <field name="model">purchase.order.automation</field>
        <field name="arch" type="xml">
            <form string="Dashboard de Automatización de Órdenes de Compra">
                <group>
                    <field name="start_date"/>
                    <field name="end_date"/>
                    <button string="Ejecutar Automatización" type="object" name="create_or_update_purchase_orders" class="btn-primary"/>
                </group>
            </form>
        </field>
    </record>


    <!--    Form view of the merge RFQ wizard-->
    <record id="merge_rfq_view_form222222" model="ir.ui.view">
        <field name="name">merge.rfq.view.form</field>
        <field name="model">merge.rfq</field>
        <field name="arch" type="xml">
            <form string="Purchase Order Merge">
                <group>
                    <field name="merge_type" required="1"/>
                    <field name="partner_id"
                           attrs="{'invisible': [('merge_type','in',['cancel_and_merge','delete_and_merge'])], 'required': [('merge_type','not in',['cancel_and_merge','delete_and_merge'])]}"/>
                    <field name="purchase_order_id"
                           attrs="{'invisible': [('merge_type','in',['cancel_and_new','delete_and_new'])], 'required': [('merge_type','not in',['cancel_and_new','delete_and_new'])]}"/>
                </group>
                <footer>
                    <button name="action_merge_orders" string="Merge Orders"
                            type="object" class="btn-primary"/>
                    <button string="Cancel" class="btn-default"
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>



    <record id="view_res_partner_supplier_update_form" model="ir.ui.view">
        <field name="name">res.partner.supplier.update.form</field>
        <field name="model">supplier.update</field>
        <field name="arch" type="xml">
            <form string="Actualizar Proveedor Principal y Reordenar Automáticamente">
                <group>
                    <field name="partner_id"/>
                </group>
                <footer>
                    <button string="Actualizar Productos" type="object" name="update_supplier_products" class="btn-primary"/>
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>


    <menuitem id="menu_res_partner_supplier_update" name="Actualizar Proveedor Principal" parent="purchase.menu_purchase_root"/>


    <record id="action_res_partner_supplier_update_form" model="ir.actions.act_window">
        <field name="name">Actualizar Proveedor Principal</field>
        <field name="res_model">supplier.update</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="view_res_partner_supplier_update_form"/>
        <field name="target">new</field>
        <field name="binding_model_id" ref="purchase.model_purchase_order"/>
        <field name="binding_view_types">list</field>
    </record>





    <!--    Form view of the merge RFQ wizard-->
    <record id="merge_rfq_view_form2" model="ir.ui.view">
        <field name="name">merge.rfq.view.form</field>
        <field name="model">merge.rfq</field>
        <field name="arch" type="xml">
            <form string="Actualizar Proveedor Principal y Reordenar Automáticamente">
                <group>
                    <field name="partner_id" domain="[('supplier_rank', '>', 0)]"/>
                </group>
                <footer>
                    <button string="Actualizar Productos" type="object" name="update_supplier_products" class="btn-primary"/>
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    <!--    Action for merge RFQ wizard-->
    <record id="merge_rfq_action2" model="ir.actions.act_window">
        <field name="name">Actualizar Productos</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">merge.rfq</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="merge_rfq_view_form2"/>
        <field name="target">new</field>
        <field name="binding_model_id" ref="purchase.model_purchase_order"/>
        <field name="binding_view_types">list</field>
    </record>

    <menuitem action="merge_rfq_action2" id="menu_loan_req2" parent="sub_menu_auto" name="Actualizar Productos" sequence="3"/>




    <record model="ir.ui.view" id="res_partner_list_view_custom">
        <field name="name">res.partner.list.view</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='email']" position="after">
                <field name="property_supplier_payment_term_id"/>
                <field name="category_id" widget="many2many_tags"/>
                
            </xpath>
        </field>
    </record>





    <record id="merge_rfq_view_form3" model="ir.ui.view">
        <field name="name">merge.rfq.view.form</field>
        <field name="model">merge.rfq</field>
        <field name="arch" type="xml">
            <form string="Actualizar Proveedor Principal y Reordenar Automáticamente">
                <group>
                    <field name="partner_id" domain="[('supplier_rank', '>', 0)]"/>
                </group>
                <footer>
                    <button string="Actualizar Cantidad" type="object" name="update_quant_products" class="btn-primary"/>
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    <!--    Action for merge RFQ wizard-->
    <record id="merge_rfq_action3" model="ir.actions.act_window">
        <field name="name">Actualizar Cantidades</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">merge.rfq</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="merge_rfq_view_form3"/>
        <field name="target">new</field>
        <field name="binding_model_id" ref="purchase.model_purchase_order"/>
        <field name="binding_view_types">list</field>
    </record>

    <menuitem action="merge_rfq_action3" id="menu_loan_req3" parent="sub_menu_auto" name="Actualizar Productos a Cero" sequence="4"/>



    <record id="action_mark_selected" model="ir.actions.server">
        <field name="name">Auto Procesar</field>
        <field name="model_id" ref="purchase.model_purchase_order"/>
        <field name="binding_model_id" ref="purchase.model_purchase_order"/>
        <field name="state">code</field>
        <field name="code">action = env['purchase.order'].browse(env.context.get('active_ids')).action_mark_selected()</field>
    </record>

    <record id="purchase_order_tree_view" model="ir.ui.view">
        <field name="name">purchase.order.tree</field>
        <field name="model">purchase.order</field>
        <field name="arch" type="xml">
            <tree string="Purchase Orders">
                <!-- Otros campos de la vista -->
                <field name="is_selected"/>
                <button name="action_mark_selected" type="object" string="Mark Selected" class="oe_highlight" />
            </tree>
        </field>
    </record>



    <record id="view_purchase_order_filter_custome" model="ir.ui.view">
            <field name="name">request.quotation.select</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.view_purchase_order_filter"/>
            <field name="arch" type="xml">
                
                <xpath expr="//search" position="replace">
                    

                   <search string="Search Purchase Order">
                        <field name="name" string="Order"
                            filter_domain="['|', '|', ('name', 'ilike', self), ('partner_ref', 'ilike', self), ('partner_id', 'child_of', self)]"/>
                        <field name="partner_id" operator="child_of"/>
                        <field name="user_id"/>
                        <field name="product_id"/>
                        <field name="origin"/>
                        <filter name="my_purchases" string="Mis Compras" domain="[('user_id', '=', uid)]"/>
                        <filter string="Destacado" name="starred" domain="[('priority', '=', '1')]"/>
                        <separator/>
                        <filter name="draft" string="Cotizaciones" domain="[('state', 'in', ('draft', 'sent', 'to approve'))]"/>
                        <separator/>
                        <filter name="is_selected" string="Auto Procesado" domain="[('is_selected', '=', True)]"/>
                        <separator/>
                        <filter string="Factura" name="is_invoice" domain="[('is_invoice', '=', False)]"/>
                        <separator/>
                        <filter name="approved" string="Ordenes de compras" domain="[('state', 'in', ('purchase', 'done'))]"/>
                        <filter name="to_approve" string="Para a Probar" domain="[('state', '=', 'to approve')]"/>
                        <separator/>
                        <filter name="order_date" string="Fecha" date="date_order"/>
                        <filter name="draft_rfqs" string="Draft RFQs" domain="[('state', '=', 'draft')]"/>
                        <filter name="waiting_rfqs" string="Waiting RFQs" domain="[('state', '=', 'sent'), ('date_order', '&gt;=', datetime.datetime.now())]"/>
                        <filter name="late_rfqs" string="Late RFQs" domain="[('state', 'in', ['draft', 'sent', 'to approve']),('date_order', '&lt;', datetime.datetime.now())]"/>
                        <separator/>
                        <filter invisible="1" string="Late Activities" name="activities_overdue"
                            domain="[('my_activity_date_deadline', '&lt;', context_today().strftime('%Y-%m-%d'))]"
                            help="Show all records which has next action date is before today"/>
                        <filter invisible="1" string="Today Activities" name="activities_today"
                            domain="[('my_activity_date_deadline', '=', context_today().strftime('%Y-%m-%d'))]"/>
                        <filter invisible="1" string="Future Activities" name="activities_upcoming_all"
                            domain="[('my_activity_date_deadline', '&gt;', context_today().strftime('%Y-%m-%d'))]"/>
                        <separator/>
                        <filter string="Warnings" name="activities_exception"
                            domain="[('activity_exception_decoration', '!=', False)]"/>
                        <group expand="0" string="Group By">
                            <filter string="Vendor" name="vendor" domain="[]" context="{'group_by': 'partner_id'}"/>
                            <filter string="Purchase Representative" name="representative" domain="[]" context="{'group_by': 'user_id'}"/>
                            <filter string="Order Date" name="order_date" domain="[]" context="{'group_by': 'date_order'}"/>
                        </group>
                    </search>


                </xpath>


            </field>
        </record>


    <record id="purchase_order_tree" model="ir.ui.view">
        <field name="name">purchase.order.tree</field>
        <field name="model">purchase.order</field>
        <field name="inherit_id" ref="purchase.purchase_order_tree"/>
        <field name="priority" eval="1"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="replace">
                <tree string="Purchase Order"
                      decoration-muted="state=='cancel'" sample="1">
                    <field name="priority" optional="show" widget="priority" nolabel="1"/>
                    <field name="partner_ref" optional="hide"/>
                    <field name="name" string="Reference" readonly="1" decoration-info="state in ('draft','sent')"/>
                    <field name="date_order" invisible="not context.get('quotation_only', False)" optional="show"/>
                    <field name="date_approve" invisible="context.get('quotation_only', False)" optional="show"/>
                    <field name="partner_id" readonly="1"/>
                    <field name="company_id" readonly="1" options="{'no_create': True}"
                        groups="base.group_multi_company" optional="show"/>
                    <field name="date_planned" invisible="context.get('quotation_only', False)" optional="show"/>
                    <field name="user_id" optional="show"/>
                    <field name="origin" optional="show"/>
                    <field name="is_selected" optional="show"/>
                    <field name="amount_untaxed" sum="Total Untaxed amount" string="Untaxed" widget="monetary" optional="hide"/>
                    <field name="amount_total" sum="Total amount" widget="monetary" optional="show"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="state" optional="show"/>
                    <field name="invoice_status" optional="hide"/>
                    <field name="activity_exception_decoration" widget="activity_exception"/>
                </tree>
            </xpath>
        </field>
    </record>







</odoo>
